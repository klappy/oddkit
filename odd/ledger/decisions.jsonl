{"id":"dec-20260129-0001","timestamp":"2026-01-29T14:30:00Z","title":"Canon-target-first freshness protocol","status":"accepted","decision":"Derived prompts must check oddkit_policy_version for the authoritative canon_target before proposing updates, and must only update to that target — never to intermediate versions","context":"Derived agent prompts can become stale. Without a protocol, prompts might update to arbitrary versions, creating drift and confusion. We needed a consistent freshness mechanism.","options_considered":[{"option":"Always use latest commit","pros":["Simple","Always fresh"],"cons":["Unstable — intermediate commits may be broken or incomplete","No human gate"]},{"option":"Pin forever, manual updates only","pros":["Stable","Human controlled"],"cons":["Prompts go stale silently","No mechanism to detect drift"]},{"option":"Canon-target-first (chosen)","pros":["Compares against authoritative target","Human controls canon_target promotion","Detects staleness without forcing updates"],"cons":["Requires oddkit tooling","Slightly more complex"]}],"rationale":["Prevents wasted updates to intermediate versions","Preserves human authority over what counts as canonical","Makes staleness visible without being naggy","Already exercised in odd-epistemic-guide"],"consequences":["Derived prompts include canon_pinned_commit in frontmatter","Freshness check runs once per session at first gating moment","Soft refresh is advisory, hard refresh requires human approval"],"evidence":[{"type":"artifact","ref":"~/.cursor/agents/odd-epistemic-guide.md"},{"type":"doc","ref":"klappy://canon/agents/odd-epistemic-guide"}],"links":["klappy://canon/agents/odd-epistemic-guide","klappy://canon/agents/odd-scribe"],"supersedes":[],"superseded_by":null,"candidate_promotion":"canon-decision-record"}
{"id":"dec-20260129-0002","timestamp":"2026-01-29T14:35:00Z","title":"Orientation docs live in klappy.dev; oddkit contains pointers","status":"accepted","decision":"Canonical ODD orientation and agent role documentation lives in klappy.dev. The oddkit repo contains pointers and tool-specific docs, not duplicated canon.","context":"With two repos (klappy.dev for canon, oddkit for tooling), we needed clarity on where orientation material belongs. Duplication creates drift; unclear boundaries create confusion.","options_considered":[{"option":"All docs in oddkit","pros":["Single location","Simpler for tool users"],"cons":["Conflates tool docs with canonical truth","oddkit becomes bloated with non-tool content"]},{"option":"All docs in klappy.dev","pros":["Single source of truth","Clear authority"],"cons":["Tool users must navigate two repos","Getting started friction"]},{"option":"Canon in klappy.dev, pointers in oddkit (chosen)","pros":["Clear separation of concerns","Canon stays authoritative","oddkit stays focused on tooling","Pointers reduce friction without duplicating"],"cons":["Two repos to maintain","Must keep pointers fresh"]}],"rationale":["klappy.dev is already the canonical truth location","oddkit is a tool, not a doctrine","Pointers are cheaper to maintain than duplicates","Follows existing pattern with odd-epistemic-guide"],"consequences":["oddkit/docs/getting-started/ contains pointers to klappy.dev canon","Agent roles are defined in klappy.dev/canon/agents/","Derived prompts in ~/.cursor/agents/ cite klappy:// URIs as source"],"evidence":[{"type":"artifact","ref":"/Users/chrisklapp/oddkit/docs/getting-started/odd-agents-and-mcp.md"},{"type":"artifact","ref":"/Users/chrisklapp/klappy.dev/canon/agents/odd-epistemic-guide.md"}],"links":["klappy://canon/agents/odd-epistemic-guide","klappy://canon/agents/odd-scribe"],"supersedes":[],"superseded_by":null,"candidate_promotion":"canon-decision-record"}
{"id":"dec-20260129-0003","timestamp":"2026-01-29T14:40:00Z","title":"Learnings and Decisions are first-class documentation citizens","status":"accepted","decision":"Learnings and Decisions are captured in append-only JSONL ledgers as first-class documentation, with a promotion ladder to canon","context":"Valuable insights were evaporating between sessions. Decisions were being relitigated because rationale was not preserved. We needed a low-ceremony capture mechanism that could escalate to durable canon.","options_considered":[{"option":"Ad-hoc notes in various places","pros":["No ceremony","Flexible"],"cons":["Things get lost","No structure for retrieval","Repeated re-teaching"]},{"option":"Everything goes straight to canon","pros":["Permanent","Authoritative"],"cons":["Too much friction for quick captures","Canon becomes cluttered","Premature formalization"]},{"option":"Ledger-first with promotion ladder (chosen)","pros":["Low ceremony capture","Structured for retrieval","Selective promotion keeps canon clean","Append-only is merge-friendly"],"cons":["Two-tier system to understand","Requires Scribe agent role"]}],"rationale":["Captures value without blocking flow","Promotion is selective and human-controlled","JSONL is automation-ready","Separates 'remembering' from 'formalizing'"],"consequences":["odd/ledger/learnings.jsonl and decisions.jsonl exist in projects","Scribe agent role records entries","Promotion to canon requires human review","Decision records become citable via klappy:// URIs"],"evidence":[{"type":"artifact","ref":"/Users/chrisklapp/klappy.dev/canon/agents/odd-scribe.md"},{"type":"artifact","ref":"/Users/chrisklapp/klappy.dev/canon/decisions/decision-record-standard.md"}],"links":["klappy://canon/agents/odd-scribe","klappy://canon/decisions/decision-record-standard"],"supersedes":[],"superseded_by":null,"candidate_promotion":"canon-decision-record"}
{"id":"dec-20260129-0004","timestamp":"2026-01-29T18:21:52Z","title":"Preserve git history; prefer new commits over rewriting","status":"accepted","decision":"When offered the option to amend a commit, always create a new commit instead. Do not rewrite git history. We need to learn from mistakes, not hide them.","context":"User was offered the option to amend a previous commit to include new evidence. They explicitly declined and stated their principle: no, create a new commit, I cannot stand rewritten history, we need to learn from mistakes, not hide them.","options_considered":[{"option":"Amend/rewrite commits","pros":["Cleaner history","Single commit per logical change"],"cons":["Hides mistakes and learning process","Rewrites history","Prevents learning from errors","Violates epistemic principle of preserving evidence"]},{"option":"Create new commits (chosen)","pros":["Preserves full history","Enables learning from mistakes","Shows actual development process","Maintains epistemic integrity"],"cons":["May result in messier history","More commits to review"]}],"rationale":["Epistemic principle: we learn from mistakes, not by hiding them","Preserving history maintains evidence of the actual development process","Rewritten history obscures the learning journey","Append-only approach aligns with ledger philosophy"],"consequences":["Git history reflects actual development process","Mistakes and corrections are visible and learnable","No git history rewriting (amend, rebase, etc.)","May require more careful commit hygiene upfront"],"evidence":[{"type":"artifact","ref":"session-conversation-2026-01-29"}],"links":[],"supersedes":[],"superseded_by":null,"candidate_promotion":"canon-decision-record"}
